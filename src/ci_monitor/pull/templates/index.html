{%extends "base.html"%}
{%block header_tag%}
<style>
div.button {
	height:75px;
}
</style>
{%endblock%}
{%block content%}

<div id="buttons" style="width:100%;height:50px;">
	<div style="float: left;"><button id="add_job">+ Job</button></div>
	<div style="float: right;"><button id="login" style="display:{%if user.is_authenticated %}none;{%else%}block;{%endif%}">Login</button></div>
	<div style="float: right;"><button id="logout" style="display:{%if user.is_authenticated %}block;{%else%}none;{%endif%}">Logout</button></div>
</div>
<div id="widgets">
	{%for job in jobs%}
		<script>
			var count = $("#widgets").children().length;
			$widget = new Widget('{{job.ci_job.ci_server.hostname}}','{{job.ci_job.jobname}}','{{job.displayname}}','{{job.ci_job.status}}','{{job.pk}}',count);
			$widget.draw('{{job.width}}','{{job.height}}','{{job.left}}','{{job.top}}');
			
			if (typeof(widget_map['{{job.ci_job.ci_server.hostname}}']) != 'undefined') {
				widget_map['{{job.ci_job.ci_server.hostname}}'].push($widget);
			} else {
				$widgets = [$widget];
				widget_map['{{job.ci_job.ci_server.hostname}}'] = $widgets; 
			}
		</script>
	{%endfor%}
</div>
<div>{%if request.user %}<input id="userid" value="{{request.user.id}}"/>{%endif%}</div>
{%csrf_token%}
{%endblock%}
